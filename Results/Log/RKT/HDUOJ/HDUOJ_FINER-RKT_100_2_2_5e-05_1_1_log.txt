Namespace(batch_size=32, data_dir='./data/HDUOJ', data_name='HDUOJ', dataset_type='HDUOJ', decay_epoch=20, final_fc_dim=100, final_lr=1e-05, future_sequence_len=2, generate_files=0, gpu=2, init_lr=0.01, init_std=0.1, learning_trend_embed_dim=200, load='HDUOJ', lr=0.01, lr_decay=0, max_iter=20, maxgradnorm=50.0, memory_key_state_dim=50, memory_size=20, memory_value_state_dim=200, model_type='FINER-RKT', momentum=0.9, n_question=5320, num_attention_heads=4, picture=1, q_embed_dim=50, qa_embed_dim=200, read_dim=100, save='HDUOJ', seed=1, seqlen=100, show=True, similar_user_num=2, test=False, train_test=0, wd=5e-05)Epoch 1/20, loss : 0.31164, auc : 0.93205, accuracy : 0.87545
Epoch 1/20, valid auc : 0.91931, valid accuracy : 0.85434
0.0000 to 0.9193
test_auc: 0.6132	test_accuracy: 0.5383	test_loss: 0.6990	
0test_auc: 0.8482	test_accuracy: 0.8159	test_loss: 0.4483	
1test_auc: 0.9029	test_accuracy: 0.8620	test_loss: 0.3541	
2test_auc: 0.9234	test_accuracy: 0.8785	test_loss: 0.3158	
3test_auc: 0.9278	test_accuracy: 0.8833	test_loss: 0.3067	
4test_auc: 0.9278	test_accuracy: 0.8792	test_loss: 0.3083	
5test_auc: 0.9293	test_accuracy: 0.8818	test_loss: 0.3040	
6test_auc: 0.9335	test_accuracy: 0.8854	test_loss: 0.2987	
7test_auc: 0.9333	test_accuracy: 0.8851	test_loss: 0.2988	
8test_auc: 0.9335	test_accuracy: 0.8837	test_loss: 0.3009	
9test_auc: 0.9333	test_accuracy: 0.8800	test_loss: nan	
10test_auc: 0.9308	test_accuracy: 0.8804	test_loss: nan	
11test_auc: 0.9340	test_accuracy: 0.8790	test_loss: nan	
12test_auc: 0.9326	test_accuracy: 0.8823	test_loss: nan	
13test_auc: 0.9360	test_accuracy: 0.8857	test_loss: nan	
14test_auc: 0.9360	test_accuracy: 0.8821	test_loss: nan	
15test_auc: 0.9349	test_accuracy: 0.8833	test_loss: nan	
16test_auc: 0.9358	test_accuracy: 0.8803	test_loss: nan	
17test_auc: 0.9331	test_accuracy: 0.8825	test_loss: nan	
18test_auc: 0.9359	test_accuracy: 0.8866	test_loss: nan	
19test_auc: 0.9339	test_accuracy: 0.8822	test_loss: nan	
20test_auc: 0.9362	test_accuracy: 0.8855	test_loss: nan	
21test_auc: 0.9340	test_accuracy: 0.8796	test_loss: nan	
22test_auc: 0.9386	test_accuracy: 0.8866	test_loss: nan	
23test_auc: 0.9386	test_accuracy: 0.8832	test_loss: nan	
24test_auc: 0.9342	test_accuracy: 0.8841	test_loss: nan	
25test_auc: 0.9351	test_accuracy: 0.8839	test_loss: nan	
26test_auc: 0.9301	test_accuracy: 0.8765	test_loss: nan	
27test_auc: 0.9337	test_accuracy: 0.8780	test_loss: nan	
28test_auc: 0.9369	test_accuracy: 0.8824	test_loss: nan	
29test_auc: 0.9324	test_accuracy: 0.8816	test_loss: nan	
30test_auc: 0.9355	test_accuracy: 0.8819	test_loss: nan	
31test_auc: 0.9306	test_accuracy: 0.8762	test_loss: nan	
32test_auc: 0.9390	test_accuracy: 0.8840	test_loss: nan	
33test_auc: 0.9325	test_accuracy: 0.8840	test_loss: nan	
34test_auc: 0.9282	test_accuracy: 0.8751	test_loss: nan	
35test_auc: 0.9266	test_accuracy: 0.8755	test_loss: nan	
36test_auc: 0.9261	test_accuracy: 0.8757	test_loss: nan	
37test_auc: 0.9367	test_accuracy: 0.8831	test_loss: nan	
38test_auc: 0.9342	test_accuracy: 0.8820	test_loss: nan	
39test_auc: 0.9339	test_accuracy: 0.8776	test_loss: nan	
40test_auc: 0.9317	test_accuracy: 0.8819	test_loss: nan	
41test_auc: 0.9350	test_accuracy: 0.8858	test_loss: nan	
42test_auc: 0.9360	test_accuracy: 0.8830	test_loss: nan	
43test_auc: 0.9326	test_accuracy: 0.8821	test_loss: nan	
44test_auc: 0.9330	test_accuracy: 0.8824	test_loss: nan	
45test_auc: 0.9312	test_accuracy: 0.8753	test_loss: nan	
46test_auc: 0.9354	test_accuracy: 0.8841	test_loss: nan	
47test_auc: 0.9286	test_accuracy: 0.8778	test_loss: nan	
48test_auc: 0.9302	test_accuracy: 0.8766	test_loss: nan	
49test_auc: 0.9357	test_accuracy: 0.8831	test_loss: nan	
50test_auc: 0.9330	test_accuracy: 0.8830	test_loss: nan	
51test_auc: 0.9330	test_accuracy: 0.8815	test_loss: nan	
52test_auc: 0.9334	test_accuracy: 0.8843	test_loss: nan	
53test_auc: 0.9367	test_accuracy: 0.8822	test_loss: nan	
54test_auc: 0.9337	test_accuracy: 0.8806	test_loss: nan	
55test_auc: 0.9375	test_accuracy: 0.8903	test_loss: nan	
56test_auc: 0.9250	test_accuracy: 0.8699	test_loss: nan	
57test_auc: 0.9375	test_accuracy: 0.8875	test_loss: nan	
58test_auc: 0.9368	test_accuracy: 0.8808	test_loss: nan	
59test_auc: 0.9352	test_accuracy: 0.8758	test_loss: nan	
60test_auc: 0.9372	test_accuracy: 0.8844	test_loss: nan	
61test_auc: 0.9347	test_accuracy: 0.8781	test_loss: nan	
62test_auc: 0.9313	test_accuracy: 0.8791	test_loss: nan	
63test_auc: 0.9411	test_accuracy: 0.8855	test_loss: nan	
64test_auc: 0.9422	test_accuracy: 0.8869	test_loss: nan	
65test_auc: 0.9308	test_accuracy: 0.8774	test_loss: nan	
66test_auc: 0.9332	test_accuracy: 0.8789	test_loss: nan	
67test_auc: 0.9358	test_accuracy: 0.8850	test_loss: nan	
68test_auc: 0.9375	test_accuracy: 0.8802	test_loss: nan	
69test_auc: 0.9332	test_accuracy: 0.8829	test_loss: nan	
70test_auc: 0.9327	test_accuracy: 0.8808	test_loss: nan	
71test_auc: 0.9345	test_accuracy: 0.8823	test_loss: nan	
72test_auc: 0.9400	test_accuracy: 0.8914	test_loss: nan	
73test_auc: 0.9435	test_accuracy: 0.8918	test_loss: nan	
74test_auc: 0.9362	test_accuracy: 0.8871	test_loss: nan	
75test_auc: 0.9432	test_accuracy: 0.8913	test_loss: nan	
76test_auc: 0.9376	test_accuracy: 0.8815	test_loss: nan	
77test_auc: 0.9391	test_accuracy: 0.8856	test_loss: nan	
78test_auc: 0.9342	test_accuracy: 0.8831	test_loss: nan	
79test_auc: 0.9382	test_accuracy: 0.8790	test_loss: nan	
80test_auc: 0.9361	test_accuracy: 0.8841	test_loss: nan	
81test_auc: 0.9341	test_accuracy: 0.8844	test_loss: nan	
82test_auc: 0.9349	test_accuracy: 0.8786	test_loss: nan	
83test_auc: 0.9367	test_accuracy: 0.8855	test_loss: nan	
84test_auc: 0.9369	test_accuracy: 0.8900	test_loss: nan	
85test_auc: 0.9288	test_accuracy: 0.8794	test_loss: nan	
86test_auc: 0.9358	test_accuracy: 0.8889	test_loss: nan	
87test_auc: 0.9340	test_accuracy: 0.8891	test_loss: nan	
88test_auc: 0.9311	test_accuracy: 0.8802	test_loss: nan	
89test_auc: 0.9385	test_accuracy: 0.8817	test_loss: nan	
90test_auc: 0.9255	test_accuracy: 0.8725	test_loss: nan	
91test_auc: 0.9321	test_accuracy: 0.8800	test_loss: nan	
92test_auc: 0.9358	test_accuracy: 0.8778	test_loss: nan	
93test_auc: 0.9355	test_accuracy: 0.8840	test_loss: nan	
94test_auc: 0.9293	test_accuracy: 0.8777	test_loss: nan	
95test_auc: 0.9255	test_accuracy: 0.8779	test_loss: nan	
96test_auc: 0.9219	test_accuracy: 0.8663	test_loss: nan	
97test_auc: 0.9288	test_accuracy: 0.8811	test_loss: nan	
98test_auc: 0.9281	test_accuracy: 0.8792	test_loss: nan	
99Epoch 2/20, loss : 0.28236, auc : 0.94563, accuracy : 0.89140
Epoch 2/20, valid auc : 0.92059, valid accuracy : 0.85860
0.9193 to 0.9206
test_auc: 0.6136	test_accuracy: 0.5725	test_loss: 0.6850	
0test_auc: 0.8504	test_accuracy: 0.8228	test_loss: 0.4426	
1test_auc: 0.9042	test_accuracy: 0.8635	test_loss: 0.3551	
2test_auc: 0.9235	test_accuracy: 0.8810	test_loss: 0.3155	
3test_auc: 0.9282	test_accuracy: 0.8843	test_loss: 0.3057	
4test_auc: 0.9281	test_accuracy: 0.8806	test_loss: 0.3078	
5test_auc: 0.9292	test_accuracy: 0.8832	test_loss: 0.3039	
6test_auc: 0.9340	test_accuracy: 0.8858	test_loss: 0.2976	
7test_auc: 0.9343	test_accuracy: 0.8858	test_loss: 0.2969	
8test_auc: 0.9342	test_accuracy: 0.8852	test_loss: 0.2998	
9test_auc: 0.9336	test_accuracy: 0.8813	test_loss: nan	
10test_auc: 0.9315	test_accuracy: 0.8818	test_loss: nan	
11test_auc: 0.9337	test_accuracy: 0.8791	test_loss: nan	
12test_auc: 0.9330	test_accuracy: 0.8838	test_loss: nan	
13test_auc: 0.9368	test_accuracy: 0.8882	test_loss: nan	
14test_auc: 0.9361	test_accuracy: 0.8832	test_loss: nan	
15test_auc: 0.9349	test_accuracy: 0.8818	test_loss: nan	
16test_auc: 0.9357	test_accuracy: 0.8791	test_loss: nan	
17test_auc: 0.9332	test_accuracy: 0.8826	test_loss: nan	
18test_auc: 0.9363	test_accuracy: 0.8859	test_loss: nan	
19test_auc: 0.9346	test_accuracy: 0.8850	test_loss: nan	
20test_auc: 0.9365	test_accuracy: 0.8868	test_loss: nan	
21test_auc: 0.9343	test_accuracy: 0.8808	test_loss: nan	
22test_auc: 0.9390	test_accuracy: 0.8875	test_loss: nan	
23test_auc: 0.9387	test_accuracy: 0.8855	test_loss: nan	
24test_auc: 0.9339	test_accuracy: 0.8856	test_loss: nan	
25test_auc: 0.9349	test_accuracy: 0.8848	test_loss: nan	
26test_auc: 0.9299	test_accuracy: 0.8788	test_loss: nan	
27test_auc: 0.9339	test_accuracy: 0.8785	test_loss: nan	
28test_auc: 0.9370	test_accuracy: 0.8843	test_loss: nan	
29test_auc: 0.9327	test_accuracy: 0.8840	test_loss: nan	
30test_auc: 0.9356	test_accuracy: 0.8832	test_loss: nan	
31test_auc: 0.9301	test_accuracy: 0.8782	test_loss: nan	
32test_auc: 0.9386	test_accuracy: 0.8841	test_loss: nan	
33test_auc: 0.9330	test_accuracy: 0.8855	test_loss: nan	
34test_auc: 0.9285	test_accuracy: 0.8756	test_loss: nan	
35test_auc: 0.9268	test_accuracy: 0.8773	test_loss: nan	
36test_auc: 0.9264	test_accuracy: 0.8769	test_loss: nan	
37test_auc: 0.9365	test_accuracy: 0.8848	test_loss: nan	
38test_auc: 0.9344	test_accuracy: 0.8837	test_loss: nan	
39test_auc: 0.9348	test_accuracy: 0.8790	test_loss: nan	
40test_auc: 0.9324	test_accuracy: 0.8828	test_loss: nan	
41test_auc: 0.9354	test_accuracy: 0.8897	test_loss: nan	
42test_auc: 0.9361	test_accuracy: 0.8845	test_loss: nan	
43test_auc: 0.9330	test_accuracy: 0.8808	test_loss: nan	
44test_auc: 0.9331	test_accuracy: 0.8827	test_loss: nan	
45test_auc: 0.9325	test_accuracy: 0.8786	test_loss: nan	
46test_auc: 0.9356	test_accuracy: 0.8853	test_loss: nan	
47test_auc: 0.9286	test_accuracy: 0.8794	test_loss: nan	
48test_auc: 0.9299	test_accuracy: 0.8753	test_loss: nan	
49test_auc: 0.9352	test_accuracy: 0.8845	test_loss: nan	
50test_auc: 0.9335	test_accuracy: 0.8836	test_loss: nan	
51test_auc: 0.9325	test_accuracy: 0.8843	test_loss: nan	
52test_auc: 0.9344	test_accuracy: 0.8853	test_loss: nan	
53test_auc: 0.9371	test_accuracy: 0.8849	test_loss: nan	
54test_auc: 0.9338	test_accuracy: 0.8816	test_loss: nan	
55test_auc: 0.9376	test_accuracy: 0.8920	test_loss: nan	
56test_auc: 0.9243	test_accuracy: 0.8719	test_loss: nan	
57test_auc: 0.9382	test_accuracy: 0.8884	test_loss: nan	
58test_auc: 0.9377	test_accuracy: 0.8870	test_loss: nan	
59test_auc: 0.9364	test_accuracy: 0.8771	test_loss: nan	
60test_auc: 0.9367	test_accuracy: 0.8862	test_loss: nan	
61test_auc: 0.9346	test_accuracy: 0.8816	test_loss: nan	
62test_auc: 0.9309	test_accuracy: 0.8798	test_loss: nan	
63test_auc: 0.9415	test_accuracy: 0.8848	test_loss: nan	
64test_auc: 0.9423	test_accuracy: 0.8869	test_loss: nan	
65test_auc: 0.9313	test_accuracy: 0.8791	test_loss: nan	
66test_auc: 0.9341	test_accuracy: 0.8824	test_loss: nan	
67test_auc: 0.9355	test_accuracy: 0.8850	test_loss: nan	
68test_auc: 0.9379	test_accuracy: 0.8789	test_loss: nan	
69test_auc: 0.9323	test_accuracy: 0.8832	test_loss: nan	
70test_auc: 0.9323	test_accuracy: 0.8803	test_loss: nan	
71test_auc: 0.9351	test_accuracy: 0.8850	test_loss: nan	
72test_auc: 0.9412	test_accuracy: 0.8933	test_loss: nan	
73test_auc: 0.9441	test_accuracy: 0.8924	test_loss: nan	
74test_auc: 0.9369	test_accuracy: 0.8899	test_loss: nan	
75test_auc: 0.9435	test_accuracy: 0.8950	test_loss: nan	
76test_auc: 0.9374	test_accuracy: 0.8847	test_loss: nan	
77test_auc: 0.9388	test_accuracy: 0.8856	test_loss: nan	
78test_auc: 0.9346	test_accuracy: 0.8860	test_loss: nan	
79test_auc: 0.9392	test_accuracy: 0.8811	test_loss: nan	
80test_auc: 0.9373	test_accuracy: 0.8841	test_loss: nan	
81test_auc: 0.9353	test_accuracy: 0.8856	test_loss: nan	
82test_auc: 0.9354	test_accuracy: 0.8805	test_loss: nan	
83test_auc: 0.9371	test_accuracy: 0.8849	test_loss: nan	
84test_auc: 0.9378	test_accuracy: 0.8913	test_loss: nan	
85test_auc: 0.9297	test_accuracy: 0.8771	test_loss: nan	
86test_auc: 0.9368	test_accuracy: 0.8915	test_loss: nan	
87test_auc: 0.9349	test_accuracy: 0.8897	test_loss: nan	
88test_auc: 0.9320	test_accuracy: 0.8849	test_loss: nan	
89test_auc: 0.9385	test_accuracy: 0.8844	test_loss: nan	
90test_auc: 0.9258	test_accuracy: 0.8697	test_loss: nan	
91test_auc: 0.9329	test_accuracy: 0.8818	test_loss: nan	
92test_auc: 0.9367	test_accuracy: 0.8831	test_loss: nan	
93test_auc: 0.9354	test_accuracy: 0.8840	test_loss: nan	
94test_auc: 0.9298	test_accuracy: 0.8755	test_loss: nan	
95test_auc: 0.9253	test_accuracy: 0.8768	test_loss: nan	
96test_auc: 0.9235	test_accuracy: 0.8689	test_loss: nan	
97test_auc: 0.9289	test_accuracy: 0.8819	test_loss: nan	
98test_auc: 0.9293	test_accuracy: 0.8815	test_loss: nan	
99Epoch 3/20, loss : 0.27497, auc : 0.94863, accuracy : 0.89437
Epoch 3/20, valid auc : 0.92044, valid accuracy : 0.85777
Epoch 4/20, loss : 0.27039, auc : 0.95051, accuracy : 0.89615
Epoch 4/20, valid auc : 0.91998, valid accuracy : 0.85823
Epoch 5/20, loss : 0.26687, auc : 0.95194, accuracy : 0.89742
Epoch 5/20, valid auc : 0.91957, valid accuracy : 0.85798
Epoch 6/20, loss : 0.26401, auc : 0.95309, accuracy : 0.89839
Epoch 6/20, valid auc : 0.91913, valid accuracy : 0.85768
Epoch 7/20, loss : 0.26133, auc : 0.95416, accuracy : 0.89931
Epoch 7/20, valid auc : 0.91797, valid accuracy : 0.85663
Epoch 8/20, loss : 0.25815, auc : 0.95540, accuracy : 0.90030
Epoch 8/20, valid auc : 0.91731, valid accuracy : 0.85668
Epoch 9/20, loss : 0.25477, auc : 0.95670, accuracy : 0.90131
Epoch 9/20, valid auc : 0.91617, valid accuracy : 0.85612
Epoch 10/20, loss : 0.25203, auc : 0.95772, accuracy : 0.90223
Epoch 10/20, valid auc : 0.91527, valid accuracy : 0.85569
Epoch 11/20, loss : 0.25005, auc : 0.95845, accuracy : 0.90288
Epoch 11/20, valid auc : 0.91481, valid accuracy : 0.85470
Epoch 12/20, loss : 0.24814, auc : 0.95914, accuracy : 0.90370
Epoch 12/20, valid auc : 0.91376, valid accuracy : 0.85306
Epoch 13/20, loss : 0.24621, auc : 0.95981, accuracy : 0.90436
Epoch 13/20, valid auc : 0.91271, valid accuracy : 0.85260
Epoch 14/20, loss : 0.24435, auc : 0.96041, accuracy : 0.90496
Epoch 14/20, valid auc : 0.91189, valid accuracy : 0.85243
Epoch 15/20, loss : 0.24246, auc : 0.96104, accuracy : 0.90564
Epoch 15/20, valid auc : 0.91218, valid accuracy : 0.85291
Epoch 16/20, loss : 0.24064, auc : 0.96165, accuracy : 0.90640
Epoch 16/20, valid auc : 0.91054, valid accuracy : 0.85152
Epoch 17/20, loss : 0.23915, auc : 0.96214, accuracy : 0.90699
Epoch 17/20, valid auc : 0.91057, valid accuracy : 0.85188
Epoch 18/20, loss : 0.23807, auc : 0.96248, accuracy : 0.90745
Epoch 18/20, valid auc : 0.91021, valid accuracy : 0.85158
Epoch 19/20, loss : 0.23722, auc : 0.96277, accuracy : 0.90772
Epoch 19/20, valid auc : 0.90952, valid accuracy : 0.85122
Epoch 20/20, loss : 0.23645, auc : 0.96302, accuracy : 0.90804
Epoch 20/20, valid auc : 0.90880, valid accuracy : 0.85042
best outcome: best epoch: 2.0000
valid_auc: 0.9206	valid_accuracy: 0.8586	valid_loss: 0.3470	
test_auc: 0.9293	test_accuracy: 0.8815	test_loss: nan	
result[0.6135842516676695, 0.8503735529059591, 0.9042267850044761, 0.9235266823555421, 0.9282261358523584, 0.9280747109338922, 0.9292335544545055, 0.9340417697464064, 0.9343310896958081, 0.9341868122834898, 0.9336138916024401, 0.9314504138648805, 0.9337497125681942, 0.9329540170820617, 0.9367521103391463, 0.9360922846739624, 0.9349116571943298, 0.9356646826874374, 0.9332467402053184, 0.936315178820049, 0.9346374929837009, 0.9364745229284165, 0.93431956268791, 0.9390280862134835, 0.9386572852855224, 0.9339080497743267, 0.9348887309516136, 0.9298957880129658, 0.9339126895180239, 0.9370064756502537, 0.9327031124463888, 0.9355606186148356, 0.9301283558947019, 0.9386006880963512, 0.9329959881578174, 0.9285197120113581, 0.926802465450779, 0.9264346009590277, 0.9364722078955973, 0.9343650890735427, 0.9348030676872019, 0.9323701182158576, 0.9354351490854492, 0.9361460652357959, 0.9330223465762199, 0.9330993595815442, 0.9325349146192986, 0.9355500054595746, 0.9285734969050558, 0.9298651200443947, 0.935230516406426, 0.9334781446023308, 0.9324815546803206, 0.9343780608951775, 0.9370787315423142, 0.9338439793416143, 0.9376380181105896, 0.9243371510837779, 0.9381665829501066, 0.9377064898995013, 0.9363865494694154, 0.9367098570023638, 0.9345912067068145, 0.9308777736460689, 0.9415271401566299, 0.9423091084616401, 0.9312747949519081, 0.9341244121993819, 0.9355481391585763, 0.9379231570677051, 0.9322766743708509, 0.9323103154305201, 0.9350996691247756, 0.9411828594313176, 0.9440535148825264, 0.9369410906619366, 0.943450420150639, 0.9373590947716802, 0.9387532432635467, 0.9345867616913675, 0.9392324537856293, 0.9373309193700893, 0.9352910547185864, 0.9354291270875186, 0.9370522613683336, 0.9377895880044542, 0.9297445385326978, 0.9368200749735788, 0.9348549452993189, 0.9320384491219326, 0.9385119758128435, 0.9258397193307211, 0.9328935332615187, 0.9366768064980399, 0.9354117360721833, 0.9297695454946764, 0.9252649210442614, 0.9235294323621174, 0.928889456952221, 0.9293464253784258]