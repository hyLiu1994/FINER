nohup: ignoring input
Namespace(batch_size=32, data_dir='./data/assist2009', data_name='assist2009', dataset_type='assist2009', decay_epoch=20, final_fc_dim=100, final_lr=1e-05, future_sequence_len=2, generate_files=0, gpu=0, init_lr=0.01, init_std=0.1, learning_trend_embed_dim=200, load='assist2009', lr=0.01, lr_decay=0, max_iter=100, maxgradnorm=50.0, memory_key_state_dim=50, memory_size=20, memory_value_state_dim=200, model_type='SAKT', momentum=0.9, n_question=110, num_attention_heads=4, q_embed_dim=50, qa_embed_dim=200, read_dim=100, save='assist2009', seed=1, seqlen=200, show=True, similar_user_num=2, test=False, train_test=0, wd=1e-05)
./data/assist2009/assist2009_train1.csv
train_qa_data_shape:  (2697, 200)
valid_qa_data_shape:  (740, 200)
test_qa_data_shape:  (1481, 200)
device: 0
Epoch 1/100, loss : 0.64470, auc : 0.63236, accuracy : 0.66543
Epoch 1/100, valid auc : 0.70825, valid accuracy : 0.70285
0.0000 to 0.7082
test_auc: 0.7015	test_accuracy: 0.7066	test_loss: 0.5838	
Epoch 2/100, loss : 0.58438, auc : 0.69956, accuracy : 0.70541
Epoch 2/100, valid auc : 0.71611, valid accuracy : 0.70426
0.7082 to 0.7161
test_auc: 0.7088	test_accuracy: 0.7091	test_loss: 0.5771	
Epoch 3/100, loss : 0.57836, auc : 0.70624, accuracy : 0.70878
Epoch 3/100, valid auc : 0.72038, valid accuracy : 0.70607
0.7161 to 0.7204
test_auc: 0.7123	test_accuracy: 0.7104	test_loss: 0.5738	
Epoch 4/100, loss : 0.57377, auc : 0.71118, accuracy : 0.71177
Epoch 4/100, valid auc : 0.72416, valid accuracy : 0.70796
0.7204 to 0.7242
test_auc: 0.7162	test_accuracy: 0.7127	test_loss: 0.5706	
Epoch 5/100, loss : 0.57019, auc : 0.71488, accuracy : 0.71279
Epoch 5/100, valid auc : 0.72664, valid accuracy : 0.70956
0.7242 to 0.7266
test_auc: 0.7186	test_accuracy: 0.7142	test_loss: 0.5683	
Epoch 6/100, loss : 0.56627, auc : 0.71905, accuracy : 0.71518
Epoch 6/100, valid auc : 0.72956, valid accuracy : 0.71129
0.7266 to 0.7296
test_auc: 0.7216	test_accuracy: 0.7154	test_loss: 0.5655	
Epoch 7/100, loss : 0.56291, auc : 0.72235, accuracy : 0.71709
Epoch 7/100, valid auc : 0.73217, valid accuracy : 0.71228
0.7296 to 0.7322
test_auc: 0.7242	test_accuracy: 0.7164	test_loss: 0.5633	
Epoch 8/100, loss : 0.55970, auc : 0.72564, accuracy : 0.71929
Epoch 8/100, valid auc : 0.73459, valid accuracy : 0.71441
0.7322 to 0.7346
test_auc: 0.7270	test_accuracy: 0.7183	test_loss: 0.5606	
Epoch 9/100, loss : 0.55619, auc : 0.72937, accuracy : 0.72113
Epoch 9/100, valid auc : 0.73684, valid accuracy : 0.71590
0.7346 to 0.7368
test_auc: 0.7288	test_accuracy: 0.7196	test_loss: 0.5586	
Epoch 10/100, loss : 0.55332, auc : 0.73230, accuracy : 0.72268
Epoch 10/100, valid auc : 0.73891, valid accuracy : 0.71838
0.7368 to 0.7389
test_auc: 0.7311	test_accuracy: 0.7206	test_loss: 0.5565	
Epoch 11/100, loss : 0.55058, auc : 0.73469, accuracy : 0.72416
Epoch 11/100, valid auc : 0.73994, valid accuracy : 0.71910
0.7389 to 0.7399
test_auc: 0.7322	test_accuracy: 0.7217	test_loss: 0.5553	
Epoch 12/100, loss : 0.54800, auc : 0.73761, accuracy : 0.72605
Epoch 12/100, valid auc : 0.74109, valid accuracy : 0.72019
0.7399 to 0.7411
test_auc: 0.7334	test_accuracy: 0.7224	test_loss: 0.5541	
Epoch 13/100, loss : 0.54576, auc : 0.73980, accuracy : 0.72722
Epoch 13/100, valid auc : 0.74257, valid accuracy : 0.72198
0.7411 to 0.7426
test_auc: 0.7351	test_accuracy: 0.7234	test_loss: 0.5524	
Epoch 14/100, loss : 0.54245, auc : 0.74300, accuracy : 0.72944
Epoch 14/100, valid auc : 0.74435, valid accuracy : 0.72331
0.7426 to 0.7443
test_auc: 0.7369	test_accuracy: 0.7242	test_loss: 0.5510	
Epoch 15/100, loss : 0.54041, auc : 0.74575, accuracy : 0.73159
Epoch 15/100, valid auc : 0.74680, valid accuracy : 0.72548
0.7443 to 0.7468
test_auc: 0.7394	test_accuracy: 0.7257	test_loss: 0.5492	
Epoch 16/100, loss : 0.53797, auc : 0.74837, accuracy : 0.73217
Epoch 16/100, valid auc : 0.74915, valid accuracy : 0.72691
0.7468 to 0.7491
test_auc: 0.7425	test_accuracy: 0.7274	test_loss: 0.5467	
Epoch 17/100, loss : 0.53589, auc : 0.75051, accuracy : 0.73407
Epoch 17/100, valid auc : 0.75122, valid accuracy : 0.72889
0.7491 to 0.7512
test_auc: 0.7444	test_accuracy: 0.7283	test_loss: 0.5451	
Epoch 18/100, loss : 0.53370, auc : 0.75300, accuracy : 0.73550
Epoch 18/100, valid auc : 0.75273, valid accuracy : 0.72988
0.7512 to 0.7527
test_auc: 0.7456	test_accuracy: 0.7292	test_loss: 0.5439	
Epoch 19/100, loss : 0.53138, auc : 0.75514, accuracy : 0.73632
Epoch 19/100, valid auc : 0.75431, valid accuracy : 0.73005
0.7527 to 0.7543
test_auc: 0.7475	test_accuracy: 0.7303	test_loss: 0.5423	
Epoch 20/100, loss : 0.52942, auc : 0.75704, accuracy : 0.73757
Epoch 20/100, valid auc : 0.75606, valid accuracy : 0.73162
0.7543 to 0.7561
test_auc: 0.7494	test_accuracy: 0.7312	test_loss: 0.5407	
Epoch 21/100, loss : 0.52771, auc : 0.75895, accuracy : 0.73859
Epoch 21/100, valid auc : 0.75639, valid accuracy : 0.73171
0.7561 to 0.7564
test_auc: 0.7502	test_accuracy: 0.7317	test_loss: 0.5403	
Epoch 22/100, loss : 0.52555, auc : 0.76073, accuracy : 0.74006
Epoch 22/100, valid auc : 0.75790, valid accuracy : 0.73234
0.7564 to 0.7579
test_auc: 0.7513	test_accuracy: 0.7322	test_loss: 0.5391	
Epoch 23/100, loss : 0.52351, auc : 0.76292, accuracy : 0.74141
Epoch 23/100, valid auc : 0.75963, valid accuracy : 0.73255
0.7579 to 0.7596
test_auc: 0.7528	test_accuracy: 0.7331	test_loss: 0.5374	
Epoch 24/100, loss : 0.52237, auc : 0.76412, accuracy : 0.74144
Epoch 24/100, valid auc : 0.76195, valid accuracy : 0.73415
0.7596 to 0.7620
test_auc: 0.7551	test_accuracy: 0.7342	test_loss: 0.5354	
Epoch 25/100, loss : 0.51989, auc : 0.76668, accuracy : 0.74314
Epoch 25/100, valid auc : 0.76151, valid accuracy : 0.73352
Epoch 26/100, loss : 0.51885, auc : 0.76768, accuracy : 0.74405
Epoch 26/100, valid auc : 0.76357, valid accuracy : 0.73495
0.7620 to 0.7636
test_auc: 0.7566	test_accuracy: 0.7356	test_loss: 0.5344	
Epoch 27/100, loss : 0.51729, auc : 0.76927, accuracy : 0.74446
Epoch 27/100, valid auc : 0.76325, valid accuracy : 0.73440
Epoch 28/100, loss : 0.51598, auc : 0.77090, accuracy : 0.74512
Epoch 28/100, valid auc : 0.76632, valid accuracy : 0.73575
0.7636 to 0.7663
test_auc: 0.7586	test_accuracy: 0.7369	test_loss: 0.5325	
Epoch 29/100, loss : 0.51422, auc : 0.77190, accuracy : 0.74670
Epoch 29/100, valid auc : 0.76691, valid accuracy : 0.73672
0.7663 to 0.7669
test_auc: 0.7600	test_accuracy: 0.7380	test_loss: 0.5313	
Epoch 30/100, loss : 0.51225, auc : 0.77394, accuracy : 0.74766
Epoch 30/100, valid auc : 0.76601, valid accuracy : 0.73640
Epoch 31/100, loss : 0.51182, auc : 0.77441, accuracy : 0.74801
Epoch 31/100, valid auc : 0.76765, valid accuracy : 0.73785
0.7669 to 0.7676
test_auc: 0.7604	test_accuracy: 0.7384	test_loss: 0.5310	
Epoch 32/100, loss : 0.51046, auc : 0.77600, accuracy : 0.74846
Epoch 32/100, valid auc : 0.76803, valid accuracy : 0.73834
0.7676 to 0.7680
test_auc: 0.7603	test_accuracy: 0.7385	test_loss: 0.5310	
Epoch 33/100, loss : 0.50945, auc : 0.77690, accuracy : 0.74938
Epoch 33/100, valid auc : 0.76919, valid accuracy : 0.73889
0.7680 to 0.7692
test_auc: 0.7625	test_accuracy: 0.7396	test_loss: 0.5292	
Epoch 34/100, loss : 0.50824, auc : 0.77838, accuracy : 0.74996
Epoch 34/100, valid auc : 0.77038, valid accuracy : 0.73872
0.7692 to 0.7704
test_auc: 0.7639	test_accuracy: 0.7400	test_loss: 0.5285	
Epoch 35/100, loss : 0.50619, auc : 0.77969, accuracy : 0.75041
Epoch 35/100, valid auc : 0.77020, valid accuracy : 0.73990
Epoch 36/100, loss : 0.50526, auc : 0.78068, accuracy : 0.75156
Epoch 36/100, valid auc : 0.77052, valid accuracy : 0.74004
0.7704 to 0.7705
test_auc: 0.7635	test_accuracy: 0.7397	test_loss: 0.5291	
Epoch 37/100, loss : 0.50470, auc : 0.78123, accuracy : 0.75179
Epoch 37/100, valid auc : 0.77176, valid accuracy : 0.74055
0.7705 to 0.7718
test_auc: 0.7654	test_accuracy: 0.7407	test_loss: 0.5273	
Epoch 38/100, loss : 0.50294, auc : 0.78291, accuracy : 0.75218
Epoch 38/100, valid auc : 0.77233, valid accuracy : 0.74093
0.7718 to 0.7723
test_auc: 0.7657	test_accuracy: 0.7410	test_loss: 0.5267	
Epoch 39/100, loss : 0.50200, auc : 0.78345, accuracy : 0.75298
Epoch 39/100, valid auc : 0.77067, valid accuracy : 0.74006
Epoch 40/100, loss : 0.50109, auc : 0.78462, accuracy : 0.75414
Epoch 40/100, valid auc : 0.77275, valid accuracy : 0.74101
0.7723 to 0.7728
test_auc: 0.7665	test_accuracy: 0.7408	test_loss: 0.5269	
Epoch 41/100, loss : 0.49900, auc : 0.78652, accuracy : 0.75430
Epoch 41/100, valid auc : 0.77200, valid accuracy : 0.74143
Epoch 42/100, loss : 0.49872, auc : 0.78656, accuracy : 0.75523
Epoch 42/100, valid auc : 0.77250, valid accuracy : 0.74093
Epoch 43/100, loss : 0.49840, auc : 0.78735, accuracy : 0.75495
Epoch 43/100, valid auc : 0.77133, valid accuracy : 0.74030
Epoch 44/100, loss : 0.49674, auc : 0.78874, accuracy : 0.75575
Epoch 44/100, valid auc : 0.76923, valid accuracy : 0.73994
Epoch 45/100, loss : 0.49646, auc : 0.78891, accuracy : 0.75575
Epoch 45/100, valid auc : 0.77288, valid accuracy : 0.74124
0.7728 to 0.7729
test_auc: 0.7669	test_accuracy: 0.7407	test_loss: 0.5273	
Epoch 46/100, loss : 0.49497, auc : 0.79050, accuracy : 0.75674
Epoch 46/100, valid auc : 0.77453, valid accuracy : 0.74270
0.7729 to 0.7745
test_auc: 0.7680	test_accuracy: 0.7412	test_loss: 0.5265	
Epoch 47/100, loss : 0.49445, auc : 0.79092, accuracy : 0.75699
Epoch 47/100, valid auc : 0.77319, valid accuracy : 0.74192
Epoch 48/100, loss : 0.49365, auc : 0.79188, accuracy : 0.75775
Epoch 48/100, valid auc : 0.77453, valid accuracy : 0.74289
0.7745 to 0.7745
test_auc: 0.7684	test_accuracy: 0.7411	test_loss: 0.5265	
Epoch 49/100, loss : 0.49233, auc : 0.79287, accuracy : 0.75811
Epoch 49/100, valid auc : 0.77276, valid accuracy : 0.74255
Epoch 50/100, loss : 0.49117, auc : 0.79412, accuracy : 0.75811
Epoch 50/100, valid auc : 0.77401, valid accuracy : 0.74265
Epoch 51/100, loss : 0.49030, auc : 0.79460, accuracy : 0.75934
Epoch 51/100, valid auc : 0.77462, valid accuracy : 0.74255
0.7745 to 0.7746
test_auc: 0.7692	test_accuracy: 0.7419	test_loss: 0.5260	
Epoch 52/100, loss : 0.48959, auc : 0.79533, accuracy : 0.75934
Epoch 52/100, valid auc : 0.77355, valid accuracy : 0.74215
Epoch 53/100, loss : 0.48970, auc : 0.79482, accuracy : 0.76000
Epoch 53/100, valid auc : 0.77484, valid accuracy : 0.74289
0.7746 to 0.7748
test_auc: 0.7691	test_accuracy: 0.7413	test_loss: 0.5270	
Epoch 54/100, loss : 0.48839, auc : 0.79656, accuracy : 0.76025
Epoch 54/100, valid auc : 0.77467, valid accuracy : 0.74274
Epoch 55/100, loss : 0.48735, auc : 0.79731, accuracy : 0.76029
Epoch 55/100, valid auc : 0.77476, valid accuracy : 0.74299
Epoch 56/100, loss : 0.48761, auc : 0.79721, accuracy : 0.75998
Epoch 56/100, valid auc : 0.77587, valid accuracy : 0.74305
0.7748 to 0.7759
test_auc: 0.7701	test_accuracy: 0.7420	test_loss: 0.5255	
Epoch 57/100, loss : 0.48623, auc : 0.79846, accuracy : 0.76145
Epoch 57/100, valid auc : 0.77353, valid accuracy : 0.74196
Epoch 58/100, loss : 0.48506, auc : 0.79923, accuracy : 0.76209
Epoch 58/100, valid auc : 0.77469, valid accuracy : 0.74310
Epoch 59/100, loss : 0.48527, auc : 0.79932, accuracy : 0.76186
Epoch 59/100, valid auc : 0.77362, valid accuracy : 0.74192
Epoch 60/100, loss : 0.48394, auc : 0.80014, accuracy : 0.76169
Epoch 60/100, valid auc : 0.77450, valid accuracy : 0.74307
Epoch 61/100, loss : 0.48291, auc : 0.80119, accuracy : 0.76220
Epoch 61/100, valid auc : 0.77469, valid accuracy : 0.74265
Epoch 62/100, loss : 0.48246, auc : 0.80151, accuracy : 0.76323
Epoch 62/100, valid auc : 0.77393, valid accuracy : 0.74227
Epoch 63/100, loss : 0.48190, auc : 0.80221, accuracy : 0.76350
Epoch 63/100, valid auc : 0.77373, valid accuracy : 0.74179
Epoch 64/100, loss : 0.48119, auc : 0.80278, accuracy : 0.76326
Epoch 64/100, valid auc : 0.77426, valid accuracy : 0.74270
Epoch 65/100, loss : 0.48040, auc : 0.80339, accuracy : 0.76414
Epoch 65/100, valid auc : 0.77480, valid accuracy : 0.74385
Epoch 66/100, loss : 0.47939, auc : 0.80435, accuracy : 0.76505
Epoch 66/100, valid auc : 0.77457, valid accuracy : 0.74305
Epoch 67/100, loss : 0.48045, auc : 0.80356, accuracy : 0.76420
Epoch 67/100, valid auc : 0.77471, valid accuracy : 0.74326
Epoch 68/100, loss : 0.47884, auc : 0.80480, accuracy : 0.76469
Epoch 68/100, valid auc : 0.77457, valid accuracy : 0.74276
Epoch 69/100, loss : 0.47740, auc : 0.80618, accuracy : 0.76571
Epoch 69/100, valid auc : 0.77326, valid accuracy : 0.74236
Epoch 70/100, loss : 0.47759, auc : 0.80574, accuracy : 0.76497
Epoch 70/100, valid auc : 0.77361, valid accuracy : 0.74274
Epoch 71/100, loss : 0.47632, auc : 0.80686, accuracy : 0.76604
Epoch 71/100, valid auc : 0.77375, valid accuracy : 0.74284
Epoch 72/100, loss : 0.47623, auc : 0.80710, accuracy : 0.76558
Epoch 72/100, valid auc : 0.77330, valid accuracy : 0.74133
Epoch 73/100, loss : 0.47490, auc : 0.80825, accuracy : 0.76620
Epoch 73/100, valid auc : 0.77176, valid accuracy : 0.74204
Epoch 74/100, loss : 0.47543, auc : 0.80765, accuracy : 0.76579
Epoch 74/100, valid auc : 0.77200, valid accuracy : 0.74227
Epoch 75/100, loss : 0.47406, auc : 0.80883, accuracy : 0.76660
Epoch 75/100, valid auc : 0.77341, valid accuracy : 0.74173
Epoch 76/100, loss : 0.47380, auc : 0.80935, accuracy : 0.76679
Epoch 76/100, valid auc : 0.77296, valid accuracy : 0.74280
Epoch 77/100, loss : 0.47239, auc : 0.81011, accuracy : 0.76821
Epoch 77/100, valid auc : 0.77349, valid accuracy : 0.74145
Epoch 78/100, loss : 0.47278, auc : 0.80981, accuracy : 0.76731
Epoch 78/100, valid auc : 0.77238, valid accuracy : 0.74135
Epoch 79/100, loss : 0.47126, auc : 0.81103, accuracy : 0.76836
Epoch 79/100, valid auc : 0.77355, valid accuracy : 0.74267
Epoch 80/100, loss : 0.47157, auc : 0.81094, accuracy : 0.76780
Epoch 80/100, valid auc : 0.76899, valid accuracy : 0.73992
Epoch 81/100, loss : 0.47092, auc : 0.81116, accuracy : 0.76834
Epoch 81/100, valid auc : 0.77126, valid accuracy : 0.74101
Epoch 82/100, loss : 0.47067, auc : 0.81170, accuracy : 0.76864
Epoch 82/100, valid auc : 0.77128, valid accuracy : 0.74049
Epoch 83/100, loss : 0.46997, auc : 0.81224, accuracy : 0.76829
Epoch 83/100, valid auc : 0.77169, valid accuracy : 0.74129
Epoch 84/100, loss : 0.46870, auc : 0.81319, accuracy : 0.76984
Epoch 84/100, valid auc : 0.77175, valid accuracy : 0.74101
Epoch 85/100, loss : 0.46854, auc : 0.81353, accuracy : 0.76964
Epoch 85/100, valid auc : 0.77126, valid accuracy : 0.74093
Epoch 86/100, loss : 0.46740, auc : 0.81459, accuracy : 0.76999
Epoch 86/100, valid auc : 0.77090, valid accuracy : 0.74129
Epoch 87/100, loss : 0.46692, auc : 0.81514, accuracy : 0.77028
Epoch 87/100, valid auc : 0.77063, valid accuracy : 0.74099
Epoch 88/100, loss : 0.46655, auc : 0.81532, accuracy : 0.77017
Epoch 88/100, valid auc : 0.76895, valid accuracy : 0.73981
Epoch 89/100, loss : 0.46642, auc : 0.81550, accuracy : 0.77061
Epoch 89/100, valid auc : 0.76944, valid accuracy : 0.73981
Epoch 90/100, loss : 0.46550, auc : 0.81602, accuracy : 0.77074
Epoch 90/100, valid auc : 0.76857, valid accuracy : 0.73901
Epoch 91/100, loss : 0.46508, auc : 0.81604, accuracy : 0.77121
Epoch 91/100, valid auc : 0.76941, valid accuracy : 0.74049
Epoch 92/100, loss : 0.46540, auc : 0.81625, accuracy : 0.77086
Epoch 92/100, valid auc : 0.77005, valid accuracy : 0.74017
Epoch 93/100, loss : 0.46409, auc : 0.81707, accuracy : 0.77121
Epoch 93/100, valid auc : 0.76912, valid accuracy : 0.74030
Epoch 94/100, loss : 0.46459, auc : 0.81685, accuracy : 0.77063
Epoch 94/100, valid auc : 0.76883, valid accuracy : 0.73882
Epoch 95/100, loss : 0.46377, auc : 0.81737, accuracy : 0.77253
Epoch 95/100, valid auc : 0.76921, valid accuracy : 0.73889
Epoch 96/100, loss : 0.46324, auc : 0.81762, accuracy : 0.77208
Epoch 96/100, valid auc : 0.76861, valid accuracy : 0.73811
Epoch 97/100, loss : 0.46330, auc : 0.81810, accuracy : 0.77245
Epoch 97/100, valid auc : 0.76702, valid accuracy : 0.73842
Epoch 98/100, loss : 0.46235, auc : 0.81853, accuracy : 0.77288
Epoch 98/100, valid auc : 0.76834, valid accuracy : 0.73889
Epoch 99/100, loss : 0.46147, auc : 0.81907, accuracy : 0.77267
Epoch 99/100, valid auc : 0.76826, valid accuracy : 0.73825
Epoch 100/100, loss : 0.46089, auc : 0.82037, accuracy : 0.77317
Epoch 100/100, valid auc : 0.76835, valid accuracy : 0.73876
best outcome: best epoch: 56.0000
valid_auc: 0.7759	valid_accuracy: 0.7431	valid_loss: 0.5232	
test_auc: 0.7701	test_accuracy: 0.7420	test_loss: 0.5255	
