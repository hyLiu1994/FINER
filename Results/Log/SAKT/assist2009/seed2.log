nohup: ignoring input
Namespace(batch_size=32, data_dir='./data/assist2009', data_name='assist2009', dataset_type='assist2009', decay_epoch=20, final_fc_dim=100, final_lr=1e-05, future_sequence_len=2, generate_files=0, gpu=0, init_lr=0.01, init_std=0.1, learning_trend_embed_dim=200, load='assist2009', lr=0.01, lr_decay=0, max_iter=100, maxgradnorm=50.0, memory_key_state_dim=50, memory_size=20, memory_value_state_dim=200, model_type='SAKT', momentum=0.9, n_question=110, num_attention_heads=4, q_embed_dim=50, qa_embed_dim=200, read_dim=100, save='assist2009', seed=2, seqlen=200, show=True, similar_user_num=2, test=False, train_test=0, wd=1e-05)
./data/assist2009/assist2009_train2.csv
train_qa_data_shape:  (2762, 200)
valid_qa_data_shape:  (675, 200)
test_qa_data_shape:  (1481, 200)
device: 0
Epoch 1/100, loss : 0.63890, auc : 0.63747, accuracy : 0.67854
Epoch 1/100, valid auc : 0.69292, valid accuracy : 0.70152
0.0000 to 0.6929
test_auc: 0.7000	test_accuracy: 0.7044	test_loss: 0.5839	
Epoch 2/100, loss : 0.58204, auc : 0.70318, accuracy : 0.70640
Epoch 2/100, valid auc : 0.70051, valid accuracy : 0.70342
0.6929 to 0.7005
test_auc: 0.7080	test_accuracy: 0.7069	test_loss: 0.5774	
Epoch 3/100, loss : 0.57589, auc : 0.71065, accuracy : 0.70964
Epoch 3/100, valid auc : 0.70363, valid accuracy : 0.70471
0.7005 to 0.7036
test_auc: 0.7116	test_accuracy: 0.7094	test_loss: 0.5740	
Epoch 4/100, loss : 0.57144, auc : 0.71531, accuracy : 0.71217
Epoch 4/100, valid auc : 0.70700, valid accuracy : 0.70630
0.7036 to 0.7070
test_auc: 0.7151	test_accuracy: 0.7117	test_loss: 0.5714	
Epoch 5/100, loss : 0.56778, auc : 0.71928, accuracy : 0.71399
Epoch 5/100, valid auc : 0.70936, valid accuracy : 0.70758
0.7070 to 0.7094
test_auc: 0.7179	test_accuracy: 0.7130	test_loss: 0.5691	
Epoch 6/100, loss : 0.56433, auc : 0.72290, accuracy : 0.71560
Epoch 6/100, valid auc : 0.71239, valid accuracy : 0.70939
0.7094 to 0.7124
test_auc: 0.7211	test_accuracy: 0.7149	test_loss: 0.5667	
Epoch 7/100, loss : 0.56041, auc : 0.72724, accuracy : 0.71804
Epoch 7/100, valid auc : 0.71486, valid accuracy : 0.71072
0.7124 to 0.7149
test_auc: 0.7240	test_accuracy: 0.7163	test_loss: 0.5642	
Epoch 8/100, loss : 0.55729, auc : 0.73060, accuracy : 0.71958
Epoch 8/100, valid auc : 0.71690, valid accuracy : 0.71188
0.7149 to 0.7169
test_auc: 0.7263	test_accuracy: 0.7174	test_loss: 0.5620	
Epoch 9/100, loss : 0.55458, auc : 0.73327, accuracy : 0.72188
Epoch 9/100, valid auc : 0.71867, valid accuracy : 0.71336
0.7169 to 0.7187
test_auc: 0.7280	test_accuracy: 0.7182	test_loss: 0.5603	
Epoch 10/100, loss : 0.55176, auc : 0.73615, accuracy : 0.72403
Epoch 10/100, valid auc : 0.71979, valid accuracy : 0.71347
0.7187 to 0.7198
test_auc: 0.7295	test_accuracy: 0.7198	test_loss: 0.5587	
Epoch 11/100, loss : 0.54937, auc : 0.73853, accuracy : 0.72541
Epoch 11/100, valid auc : 0.72270, valid accuracy : 0.71484
0.7198 to 0.7227
test_auc: 0.7322	test_accuracy: 0.7216	test_loss: 0.5563	
Epoch 12/100, loss : 0.54649, auc : 0.74192, accuracy : 0.72732
Epoch 12/100, valid auc : 0.72475, valid accuracy : 0.71672
0.7227 to 0.7248
test_auc: 0.7343	test_accuracy: 0.7230	test_loss: 0.5542	
Epoch 13/100, loss : 0.54392, auc : 0.74455, accuracy : 0.72893
Epoch 13/100, valid auc : 0.72663, valid accuracy : 0.71724
0.7248 to 0.7266
test_auc: 0.7367	test_accuracy: 0.7245	test_loss: 0.5522	
Epoch 14/100, loss : 0.54112, auc : 0.74700, accuracy : 0.72989
Epoch 14/100, valid auc : 0.72831, valid accuracy : 0.71875
0.7266 to 0.7283
test_auc: 0.7383	test_accuracy: 0.7258	test_loss: 0.5506	
Epoch 15/100, loss : 0.53875, auc : 0.74942, accuracy : 0.73176
Epoch 15/100, valid auc : 0.73026, valid accuracy : 0.71999
0.7283 to 0.7303
test_auc: 0.7406	test_accuracy: 0.7272	test_loss: 0.5486	
Epoch 16/100, loss : 0.53676, auc : 0.75166, accuracy : 0.73318
Epoch 16/100, valid auc : 0.73191, valid accuracy : 0.72090
0.7303 to 0.7319
test_auc: 0.7422	test_accuracy: 0.7278	test_loss: 0.5473	
Epoch 17/100, loss : 0.53460, auc : 0.75388, accuracy : 0.73421
Epoch 17/100, valid auc : 0.73349, valid accuracy : 0.72149
0.7319 to 0.7335
test_auc: 0.7437	test_accuracy: 0.7287	test_loss: 0.5461	
Epoch 18/100, loss : 0.53284, auc : 0.75580, accuracy : 0.73584
Epoch 18/100, valid auc : 0.73501, valid accuracy : 0.72234
0.7335 to 0.7350
test_auc: 0.7451	test_accuracy: 0.7299	test_loss: 0.5444	
Epoch 19/100, loss : 0.53066, auc : 0.75760, accuracy : 0.73683
Epoch 19/100, valid auc : 0.73760, valid accuracy : 0.72372
0.7350 to 0.7376
test_auc: 0.7476	test_accuracy: 0.7313	test_loss: 0.5424	
Epoch 20/100, loss : 0.52936, auc : 0.75874, accuracy : 0.73702
Epoch 20/100, valid auc : 0.73961, valid accuracy : 0.72396
0.7376 to 0.7396
test_auc: 0.7490	test_accuracy: 0.7313	test_loss: 0.5412	
Epoch 21/100, loss : 0.52723, auc : 0.76077, accuracy : 0.73865
Epoch 21/100, valid auc : 0.73937, valid accuracy : 0.72417
Epoch 22/100, loss : 0.52528, auc : 0.76241, accuracy : 0.73938
Epoch 22/100, valid auc : 0.74217, valid accuracy : 0.72537
0.7396 to 0.7422
test_auc: 0.7512	test_accuracy: 0.7326	test_loss: 0.5389	
Epoch 23/100, loss : 0.52384, auc : 0.76409, accuracy : 0.74044
Epoch 23/100, valid auc : 0.74237, valid accuracy : 0.72544
0.7422 to 0.7424
test_auc: 0.7517	test_accuracy: 0.7329	test_loss: 0.5383	
Epoch 24/100, loss : 0.52215, auc : 0.76589, accuracy : 0.74120
Epoch 24/100, valid auc : 0.74389, valid accuracy : 0.72651
0.7424 to 0.7439
test_auc: 0.7532	test_accuracy: 0.7337	test_loss: 0.5372	
Epoch 25/100, loss : 0.52088, auc : 0.76695, accuracy : 0.74144
Epoch 25/100, valid auc : 0.74582, valid accuracy : 0.72664
0.7439 to 0.7458
test_auc: 0.7544	test_accuracy: 0.7347	test_loss: 0.5362	
Epoch 26/100, loss : 0.51852, auc : 0.76905, accuracy : 0.74291
Epoch 26/100, valid auc : 0.74735, valid accuracy : 0.72707
0.7458 to 0.7473
test_auc: 0.7562	test_accuracy: 0.7355	test_loss: 0.5347	
Epoch 27/100, loss : 0.51794, auc : 0.76985, accuracy : 0.74374
Epoch 27/100, valid auc : 0.74626, valid accuracy : 0.72703
Epoch 28/100, loss : 0.51567, auc : 0.77178, accuracy : 0.74538
Epoch 28/100, valid auc : 0.74900, valid accuracy : 0.72879
0.7473 to 0.7490
test_auc: 0.7571	test_accuracy: 0.7365	test_loss: 0.5335	
Epoch 29/100, loss : 0.51510, auc : 0.77233, accuracy : 0.74555
Epoch 29/100, valid auc : 0.75034, valid accuracy : 0.72893
0.7490 to 0.7503
test_auc: 0.7586	test_accuracy: 0.7373	test_loss: 0.5325	
Epoch 30/100, loss : 0.51363, auc : 0.77397, accuracy : 0.74604
Epoch 30/100, valid auc : 0.75142, valid accuracy : 0.72897
0.7503 to 0.7514
test_auc: 0.7595	test_accuracy: 0.7384	test_loss: 0.5316	
Epoch 31/100, loss : 0.51199, auc : 0.77532, accuracy : 0.74672
Epoch 31/100, valid auc : 0.75029, valid accuracy : 0.72919
Epoch 32/100, loss : 0.51106, auc : 0.77634, accuracy : 0.74824
Epoch 32/100, valid auc : 0.75240, valid accuracy : 0.73043
0.7514 to 0.7524
test_auc: 0.7613	test_accuracy: 0.7390	test_loss: 0.5307	
Epoch 33/100, loss : 0.51004, auc : 0.77774, accuracy : 0.74840
Epoch 33/100, valid auc : 0.75199, valid accuracy : 0.73060
Epoch 34/100, loss : 0.50868, auc : 0.77871, accuracy : 0.74952
Epoch 34/100, valid auc : 0.75127, valid accuracy : 0.73032
Epoch 35/100, loss : 0.50766, auc : 0.77958, accuracy : 0.74959
Epoch 35/100, valid auc : 0.75293, valid accuracy : 0.73039
0.7524 to 0.7529
test_auc: 0.7618	test_accuracy: 0.7394	test_loss: 0.5297	
Epoch 36/100, loss : 0.50662, auc : 0.78067, accuracy : 0.75038
Epoch 36/100, valid auc : 0.75469, valid accuracy : 0.73156
0.7529 to 0.7547
test_auc: 0.7632	test_accuracy: 0.7404	test_loss: 0.5286	
Epoch 37/100, loss : 0.50459, auc : 0.78283, accuracy : 0.75164
Epoch 37/100, valid auc : 0.75179, valid accuracy : 0.73030
Epoch 38/100, loss : 0.50436, auc : 0.78285, accuracy : 0.75212
Epoch 38/100, valid auc : 0.75528, valid accuracy : 0.73220
0.7547 to 0.7553
test_auc: 0.7637	test_accuracy: 0.7411	test_loss: 0.5289	
Epoch 39/100, loss : 0.50315, auc : 0.78408, accuracy : 0.75220
Epoch 39/100, valid auc : 0.75686, valid accuracy : 0.73289
0.7553 to 0.7569
test_auc: 0.7658	test_accuracy: 0.7419	test_loss: 0.5271	
Epoch 40/100, loss : 0.50195, auc : 0.78506, accuracy : 0.75320
Epoch 40/100, valid auc : 0.75523, valid accuracy : 0.73246
Epoch 41/100, loss : 0.50164, auc : 0.78552, accuracy : 0.75282
Epoch 41/100, valid auc : 0.75832, valid accuracy : 0.73359
0.7569 to 0.7583
test_auc: 0.7662	test_accuracy: 0.7421	test_loss: 0.5272	
Epoch 42/100, loss : 0.50071, auc : 0.78673, accuracy : 0.75364
Epoch 42/100, valid auc : 0.75749, valid accuracy : 0.73302
Epoch 43/100, loss : 0.49948, auc : 0.78776, accuracy : 0.75425
Epoch 43/100, valid auc : 0.75701, valid accuracy : 0.73250
Epoch 44/100, loss : 0.49881, auc : 0.78824, accuracy : 0.75587
Epoch 44/100, valid auc : 0.75632, valid accuracy : 0.73296
Epoch 45/100, loss : 0.49707, auc : 0.78949, accuracy : 0.75570
Epoch 45/100, valid auc : 0.75589, valid accuracy : 0.73329
Epoch 46/100, loss : 0.49659, auc : 0.79023, accuracy : 0.75639
Epoch 46/100, valid auc : 0.75797, valid accuracy : 0.73424
Epoch 47/100, loss : 0.49594, auc : 0.79098, accuracy : 0.75706
Epoch 47/100, valid auc : 0.75870, valid accuracy : 0.73466
0.7583 to 0.7587
test_auc: 0.7673	test_accuracy: 0.7435	test_loss: 0.5267	
Epoch 48/100, loss : 0.49470, auc : 0.79224, accuracy : 0.75726
Epoch 48/100, valid auc : 0.75816, valid accuracy : 0.73390
Epoch 49/100, loss : 0.49446, auc : 0.79247, accuracy : 0.75722
Epoch 49/100, valid auc : 0.75976, valid accuracy : 0.73494
0.7587 to 0.7598
test_auc: 0.7683	test_accuracy: 0.7439	test_loss: 0.5261	
Epoch 50/100, loss : 0.49327, auc : 0.79319, accuracy : 0.75818
Epoch 50/100, valid auc : 0.75826, valid accuracy : 0.73433
Epoch 51/100, loss : 0.49269, auc : 0.79444, accuracy : 0.75910
Epoch 51/100, valid auc : 0.75935, valid accuracy : 0.73451
Epoch 52/100, loss : 0.49102, auc : 0.79532, accuracy : 0.75902
Epoch 52/100, valid auc : 0.76074, valid accuracy : 0.73590
0.7598 to 0.7607
test_auc: 0.7684	test_accuracy: 0.7440	test_loss: 0.5268	
Epoch 53/100, loss : 0.49073, auc : 0.79571, accuracy : 0.75886
Epoch 53/100, valid auc : 0.75980, valid accuracy : 0.73507
Epoch 54/100, loss : 0.49086, auc : 0.79566, accuracy : 0.75880
Epoch 54/100, valid auc : 0.76170, valid accuracy : 0.73573
0.7607 to 0.7617
test_auc: 0.7692	test_accuracy: 0.7443	test_loss: 0.5262	
Epoch 55/100, loss : 0.48893, auc : 0.79736, accuracy : 0.76003
Epoch 55/100, valid auc : 0.75920, valid accuracy : 0.73416
Epoch 56/100, loss : 0.48882, auc : 0.79750, accuracy : 0.76026
Epoch 56/100, valid auc : 0.76032, valid accuracy : 0.73564
Epoch 57/100, loss : 0.48792, auc : 0.79817, accuracy : 0.76055
Epoch 57/100, valid auc : 0.75970, valid accuracy : 0.73464
Epoch 58/100, loss : 0.48757, auc : 0.79865, accuracy : 0.76086
Epoch 58/100, valid auc : 0.76200, valid accuracy : 0.73754
0.7617 to 0.7620
test_auc: 0.7693	test_accuracy: 0.7448	test_loss: 0.5274	
Epoch 59/100, loss : 0.48641, auc : 0.79928, accuracy : 0.76083
Epoch 59/100, valid auc : 0.76134, valid accuracy : 0.73549
Epoch 60/100, loss : 0.48577, auc : 0.80007, accuracy : 0.76196
Epoch 60/100, valid auc : 0.76138, valid accuracy : 0.73588
Epoch 61/100, loss : 0.48520, auc : 0.80098, accuracy : 0.76205
Epoch 61/100, valid auc : 0.76134, valid accuracy : 0.73664
Epoch 62/100, loss : 0.48442, auc : 0.80156, accuracy : 0.76286
Epoch 62/100, valid auc : 0.76225, valid accuracy : 0.73658
0.7620 to 0.7623
test_auc: 0.7683	test_accuracy: 0.7438	test_loss: 0.5293	
Epoch 63/100, loss : 0.48366, auc : 0.80181, accuracy : 0.76302
Epoch 63/100, valid auc : 0.76303, valid accuracy : 0.73618
0.7623 to 0.7630
test_auc: 0.7703	test_accuracy: 0.7449	test_loss: 0.5270	
Epoch 64/100, loss : 0.48285, auc : 0.80275, accuracy : 0.76306
Epoch 64/100, valid auc : 0.76197, valid accuracy : 0.73588
Epoch 65/100, loss : 0.48193, auc : 0.80348, accuracy : 0.76361
Epoch 65/100, valid auc : 0.76170, valid accuracy : 0.73629
Epoch 66/100, loss : 0.48163, auc : 0.80397, accuracy : 0.76397
Epoch 66/100, valid auc : 0.76217, valid accuracy : 0.73618
Epoch 67/100, loss : 0.48042, auc : 0.80478, accuracy : 0.76485
Epoch 67/100, valid auc : 0.76100, valid accuracy : 0.73616
Epoch 68/100, loss : 0.47959, auc : 0.80558, accuracy : 0.76520
Epoch 68/100, valid auc : 0.76206, valid accuracy : 0.73594
Epoch 69/100, loss : 0.47993, auc : 0.80521, accuracy : 0.76469
Epoch 69/100, valid auc : 0.75891, valid accuracy : 0.73501
Epoch 70/100, loss : 0.47913, auc : 0.80610, accuracy : 0.76556
Epoch 70/100, valid auc : 0.76071, valid accuracy : 0.73527
Epoch 71/100, loss : 0.47820, auc : 0.80656, accuracy : 0.76531
Epoch 71/100, valid auc : 0.76122, valid accuracy : 0.73642
Epoch 72/100, loss : 0.47786, auc : 0.80678, accuracy : 0.76547
Epoch 72/100, valid auc : 0.76283, valid accuracy : 0.73664
Epoch 73/100, loss : 0.47692, auc : 0.80813, accuracy : 0.76651
Epoch 73/100, valid auc : 0.76250, valid accuracy : 0.73649
Epoch 74/100, loss : 0.47579, auc : 0.80862, accuracy : 0.76727
Epoch 74/100, valid auc : 0.76167, valid accuracy : 0.73680
Epoch 75/100, loss : 0.47594, auc : 0.80858, accuracy : 0.76712
Epoch 75/100, valid auc : 0.76205, valid accuracy : 0.73573
Epoch 76/100, loss : 0.47508, auc : 0.80931, accuracy : 0.76733
Epoch 76/100, valid auc : 0.76181, valid accuracy : 0.73697
Epoch 77/100, loss : 0.47478, auc : 0.80956, accuracy : 0.76751
Epoch 77/100, valid auc : 0.76145, valid accuracy : 0.73544
Epoch 78/100, loss : 0.47362, auc : 0.81063, accuracy : 0.76813
Epoch 78/100, valid auc : 0.76297, valid accuracy : 0.73629
Epoch 79/100, loss : 0.47357, auc : 0.81061, accuracy : 0.76802
Epoch 79/100, valid auc : 0.76196, valid accuracy : 0.73479
Epoch 80/100, loss : 0.47293, auc : 0.81105, accuracy : 0.76742
Epoch 80/100, valid auc : 0.76069, valid accuracy : 0.73435
Epoch 81/100, loss : 0.47273, auc : 0.81150, accuracy : 0.76804
Epoch 81/100, valid auc : 0.76125, valid accuracy : 0.73403
Epoch 82/100, loss : 0.47128, auc : 0.81231, accuracy : 0.76955
Epoch 82/100, valid auc : 0.76168, valid accuracy : 0.73485
Epoch 83/100, loss : 0.47162, auc : 0.81225, accuracy : 0.76871
Epoch 83/100, valid auc : 0.76062, valid accuracy : 0.73422
Epoch 84/100, loss : 0.47093, auc : 0.81265, accuracy : 0.76882
Epoch 84/100, valid auc : 0.76067, valid accuracy : 0.73479
Epoch 85/100, loss : 0.46996, auc : 0.81362, accuracy : 0.77000
Epoch 85/100, valid auc : 0.76087, valid accuracy : 0.73485
Epoch 86/100, loss : 0.46941, auc : 0.81408, accuracy : 0.77046
Epoch 86/100, valid auc : 0.76061, valid accuracy : 0.73398
Epoch 87/100, loss : 0.46891, auc : 0.81409, accuracy : 0.77045
Epoch 87/100, valid auc : 0.76050, valid accuracy : 0.73348
Epoch 88/100, loss : 0.46816, auc : 0.81542, accuracy : 0.77018
Epoch 88/100, valid auc : 0.75990, valid accuracy : 0.73390
Epoch 89/100, loss : 0.46780, auc : 0.81555, accuracy : 0.77094
Epoch 89/100, valid auc : 0.75948, valid accuracy : 0.73285
Epoch 90/100, loss : 0.46741, auc : 0.81547, accuracy : 0.77110
Epoch 90/100, valid auc : 0.76005, valid accuracy : 0.73396
Epoch 91/100, loss : 0.46738, auc : 0.81576, accuracy : 0.77092
Epoch 91/100, valid auc : 0.75921, valid accuracy : 0.73322
Epoch 92/100, loss : 0.46655, auc : 0.81657, accuracy : 0.77129
Epoch 92/100, valid auc : 0.76008, valid accuracy : 0.73394
Epoch 93/100, loss : 0.46577, auc : 0.81754, accuracy : 0.77156
Epoch 93/100, valid auc : 0.75938, valid accuracy : 0.73329
Epoch 94/100, loss : 0.46475, auc : 0.81820, accuracy : 0.77257
Epoch 94/100, valid auc : 0.75962, valid accuracy : 0.73300
Epoch 95/100, loss : 0.46443, auc : 0.81787, accuracy : 0.77255
Epoch 95/100, valid auc : 0.76021, valid accuracy : 0.73285
Epoch 96/100, loss : 0.46406, auc : 0.81862, accuracy : 0.77259
Epoch 96/100, valid auc : 0.75926, valid accuracy : 0.73411
Epoch 97/100, loss : 0.46379, auc : 0.81844, accuracy : 0.77278
Epoch 97/100, valid auc : 0.75874, valid accuracy : 0.73211
Epoch 98/100, loss : 0.46266, auc : 0.81973, accuracy : 0.77365
Epoch 98/100, valid auc : 0.75820, valid accuracy : 0.73272
Epoch 99/100, loss : 0.46295, auc : 0.81979, accuracy : 0.77372
Epoch 99/100, valid auc : 0.75837, valid accuracy : 0.73176
Epoch 100/100, loss : 0.46191, auc : 0.82064, accuracy : 0.77337
Epoch 100/100, valid auc : 0.75838, valid accuracy : 0.73128
best outcome: best epoch: 63.0000
valid_auc: 0.7630	valid_accuracy: 0.7362	valid_loss: 0.5381	
test_auc: 0.7703	test_accuracy: 0.7449	test_loss: 0.5270	
