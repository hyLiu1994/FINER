nohup: ignoring input
Namespace(batch_size=32, data_dir='./data/assist2009', data_name='assist2009', dataset_type='assist2009', decay_epoch=20, final_fc_dim=100, final_lr=1e-05, future_sequence_len=2, generate_files=0, gpu=0, init_lr=0.01, init_std=0.1, learning_trend_embed_dim=200, load='assist2009', lr=0.01, lr_decay=0, max_iter=100, maxgradnorm=50.0, memory_key_state_dim=50, memory_size=20, memory_value_state_dim=200, model_type='SAKT', momentum=0.9, n_question=110, num_attention_heads=4, q_embed_dim=50, qa_embed_dim=200, read_dim=100, save='assist2009', seed=5, seqlen=200, show=True, similar_user_num=2, test=False, train_test=0, wd=1e-05)
./data/assist2009/assist2009_train5.csv
train_qa_data_shape:  (2734, 200)
valid_qa_data_shape:  (703, 200)
test_qa_data_shape:  (1481, 200)
device: 0
Epoch 1/100, loss : 0.64333, auc : 0.63171, accuracy : 0.67508
Epoch 1/100, valid auc : 0.70278, valid accuracy : 0.70397
0.0000 to 0.7028
test_auc: 0.6991	test_accuracy: 0.7040	test_loss: 0.5946	
Epoch 2/100, loss : 0.58453, auc : 0.69999, accuracy : 0.70602
Epoch 2/100, valid auc : 0.71060, valid accuracy : 0.70782
0.7028 to 0.7106
test_auc: 0.7058	test_accuracy: 0.7072	test_loss: 0.5856	
Epoch 3/100, loss : 0.57896, auc : 0.70677, accuracy : 0.70907
Epoch 3/100, valid auc : 0.71395, valid accuracy : 0.70969
0.7106 to 0.7139
test_auc: 0.7092	test_accuracy: 0.7101	test_loss: 0.5803	
Epoch 4/100, loss : 0.57484, auc : 0.71141, accuracy : 0.71110
Epoch 4/100, valid auc : 0.71678, valid accuracy : 0.71164
0.7139 to 0.7168
test_auc: 0.7121	test_accuracy: 0.7110	test_loss: 0.5774	
Epoch 5/100, loss : 0.57094, auc : 0.71611, accuracy : 0.71339
Epoch 5/100, valid auc : 0.71975, valid accuracy : 0.71329
0.7168 to 0.7198
test_auc: 0.7156	test_accuracy: 0.7124	test_loss: 0.5748	
Epoch 6/100, loss : 0.56763, auc : 0.71984, accuracy : 0.71503
Epoch 6/100, valid auc : 0.72246, valid accuracy : 0.71465
0.7198 to 0.7225
test_auc: 0.7182	test_accuracy: 0.7136	test_loss: 0.5724	
Epoch 7/100, loss : 0.56475, auc : 0.72304, accuracy : 0.71707
Epoch 7/100, valid auc : 0.72427, valid accuracy : 0.71627
0.7225 to 0.7243
test_auc: 0.7204	test_accuracy: 0.7145	test_loss: 0.5710	
Epoch 8/100, loss : 0.56181, auc : 0.72583, accuracy : 0.71907
Epoch 8/100, valid auc : 0.72628, valid accuracy : 0.71727
0.7243 to 0.7263
test_auc: 0.7226	test_accuracy: 0.7155	test_loss: 0.5685	
Epoch 9/100, loss : 0.55917, auc : 0.72878, accuracy : 0.72040
Epoch 9/100, valid auc : 0.72825, valid accuracy : 0.71872
0.7263 to 0.7283
test_auc: 0.7250	test_accuracy: 0.7169	test_loss: 0.5661	
Epoch 10/100, loss : 0.55605, auc : 0.73261, accuracy : 0.72266
Epoch 10/100, valid auc : 0.73076, valid accuracy : 0.71910
0.7283 to 0.7308
test_auc: 0.7279	test_accuracy: 0.7186	test_loss: 0.5635	
Epoch 11/100, loss : 0.55313, auc : 0.73578, accuracy : 0.72443
Epoch 11/100, valid auc : 0.73258, valid accuracy : 0.72057
0.7308 to 0.7326
test_auc: 0.7302	test_accuracy: 0.7200	test_loss: 0.5615	
Epoch 12/100, loss : 0.55046, auc : 0.73806, accuracy : 0.72619
Epoch 12/100, valid auc : 0.73497, valid accuracy : 0.72210
0.7326 to 0.7350
test_auc: 0.7328	test_accuracy: 0.7216	test_loss: 0.5586	
Epoch 13/100, loss : 0.54730, auc : 0.74109, accuracy : 0.72707
Epoch 13/100, valid auc : 0.73699, valid accuracy : 0.72342
0.7350 to 0.7370
test_auc: 0.7356	test_accuracy: 0.7225	test_loss: 0.5561	
Epoch 14/100, loss : 0.54486, auc : 0.74397, accuracy : 0.72944
Epoch 14/100, valid auc : 0.73893, valid accuracy : 0.72426
0.7370 to 0.7389
test_auc: 0.7375	test_accuracy: 0.7239	test_loss: 0.5542	
Epoch 15/100, loss : 0.54205, auc : 0.74707, accuracy : 0.73073
Epoch 15/100, valid auc : 0.73994, valid accuracy : 0.72433
0.7389 to 0.7399
test_auc: 0.7396	test_accuracy: 0.7249	test_loss: 0.5528	
Epoch 16/100, loss : 0.53997, auc : 0.74925, accuracy : 0.73252
Epoch 16/100, valid auc : 0.74288, valid accuracy : 0.72646
0.7399 to 0.7429
test_auc: 0.7418	test_accuracy: 0.7263	test_loss: 0.5508	
Epoch 17/100, loss : 0.53728, auc : 0.75158, accuracy : 0.73430
Epoch 17/100, valid auc : 0.74459, valid accuracy : 0.72738
0.7429 to 0.7446
test_auc: 0.7436	test_accuracy: 0.7276	test_loss: 0.5493	
Epoch 18/100, loss : 0.53517, auc : 0.75424, accuracy : 0.73526
Epoch 18/100, valid auc : 0.74600, valid accuracy : 0.72873
0.7446 to 0.7460
test_auc: 0.7445	test_accuracy: 0.7281	test_loss: 0.5485	
Epoch 19/100, loss : 0.53329, auc : 0.75579, accuracy : 0.73654
Epoch 19/100, valid auc : 0.74806, valid accuracy : 0.73000
0.7460 to 0.7481
test_auc: 0.7472	test_accuracy: 0.7299	test_loss: 0.5459	
Epoch 20/100, loss : 0.53109, auc : 0.75816, accuracy : 0.73771
Epoch 20/100, valid auc : 0.74961, valid accuracy : 0.73131
0.7481 to 0.7496
test_auc: 0.7490	test_accuracy: 0.7310	test_loss: 0.5439	
Epoch 21/100, loss : 0.52878, auc : 0.76000, accuracy : 0.73911
Epoch 21/100, valid auc : 0.75178, valid accuracy : 0.73171
0.7496 to 0.7518
test_auc: 0.7501	test_accuracy: 0.7315	test_loss: 0.5434	
Epoch 22/100, loss : 0.52688, auc : 0.76207, accuracy : 0.74032
Epoch 22/100, valid auc : 0.75262, valid accuracy : 0.73314
0.7518 to 0.7526
test_auc: 0.7516	test_accuracy: 0.7326	test_loss: 0.5420	
Epoch 23/100, loss : 0.52554, auc : 0.76397, accuracy : 0.74131
Epoch 23/100, valid auc : 0.75456, valid accuracy : 0.73354
0.7526 to 0.7546
test_auc: 0.7533	test_accuracy: 0.7336	test_loss: 0.5406	
Epoch 24/100, loss : 0.52352, auc : 0.76536, accuracy : 0.74172
Epoch 24/100, valid auc : 0.75521, valid accuracy : 0.73432
0.7546 to 0.7552
test_auc: 0.7542	test_accuracy: 0.7344	test_loss: 0.5401	
Epoch 25/100, loss : 0.52170, auc : 0.76732, accuracy : 0.74339
Epoch 25/100, valid auc : 0.75720, valid accuracy : 0.73447
0.7552 to 0.7572
test_auc: 0.7563	test_accuracy: 0.7356	test_loss: 0.5385	
Epoch 26/100, loss : 0.52045, auc : 0.76826, accuracy : 0.74412
Epoch 26/100, valid auc : 0.75854, valid accuracy : 0.73552
0.7572 to 0.7585
test_auc: 0.7578	test_accuracy: 0.7362	test_loss: 0.5368	
Epoch 27/100, loss : 0.51831, auc : 0.77067, accuracy : 0.74529
Epoch 27/100, valid auc : 0.75811, valid accuracy : 0.73552
Epoch 28/100, loss : 0.51734, auc : 0.77184, accuracy : 0.74582
Epoch 28/100, valid auc : 0.75974, valid accuracy : 0.73612
0.7585 to 0.7597
test_auc: 0.7596	test_accuracy: 0.7375	test_loss: 0.5353	
Epoch 29/100, loss : 0.51613, auc : 0.77236, accuracy : 0.74650
Epoch 29/100, valid auc : 0.76086, valid accuracy : 0.73730
0.7597 to 0.7609
test_auc: 0.7603	test_accuracy: 0.7379	test_loss: 0.5346	
Epoch 30/100, loss : 0.51503, auc : 0.77385, accuracy : 0.74731
Epoch 30/100, valid auc : 0.76224, valid accuracy : 0.73821
0.7609 to 0.7622
test_auc: 0.7611	test_accuracy: 0.7383	test_loss: 0.5341	
Epoch 31/100, loss : 0.51381, auc : 0.77530, accuracy : 0.74822
Epoch 31/100, valid auc : 0.76338, valid accuracy : 0.73850
0.7622 to 0.7634
test_auc: 0.7618	test_accuracy: 0.7388	test_loss: 0.5329	
Epoch 32/100, loss : 0.51228, auc : 0.77655, accuracy : 0.74832
Epoch 32/100, valid auc : 0.76339, valid accuracy : 0.73892
0.7634 to 0.7634
test_auc: 0.7620	test_accuracy: 0.7394	test_loss: 0.5329	
Epoch 33/100, loss : 0.51077, auc : 0.77768, accuracy : 0.74950
Epoch 33/100, valid auc : 0.76505, valid accuracy : 0.73966
0.7634 to 0.7650
test_auc: 0.7632	test_accuracy: 0.7401	test_loss: 0.5317	
Epoch 34/100, loss : 0.50983, auc : 0.77866, accuracy : 0.75000
Epoch 34/100, valid auc : 0.76499, valid accuracy : 0.73948
Epoch 35/100, loss : 0.50816, auc : 0.78028, accuracy : 0.75054
Epoch 35/100, valid auc : 0.76529, valid accuracy : 0.73879
0.7650 to 0.7653
test_auc: 0.7638	test_accuracy: 0.7400	test_loss: 0.5318	
Epoch 36/100, loss : 0.50778, auc : 0.78061, accuracy : 0.75149
Epoch 36/100, valid auc : 0.76690, valid accuracy : 0.73955
0.7653 to 0.7669
test_auc: 0.7646	test_accuracy: 0.7403	test_loss: 0.5305	
Epoch 37/100, loss : 0.50640, auc : 0.78179, accuracy : 0.75165
Epoch 37/100, valid auc : 0.76496, valid accuracy : 0.73970
Epoch 38/100, loss : 0.50485, auc : 0.78308, accuracy : 0.75256
Epoch 38/100, valid auc : 0.76898, valid accuracy : 0.74146
0.7669 to 0.7690
test_auc: 0.7663	test_accuracy: 0.7412	test_loss: 0.5291	
Epoch 39/100, loss : 0.50398, auc : 0.78420, accuracy : 0.75314
Epoch 39/100, valid auc : 0.76774, valid accuracy : 0.74122
Epoch 40/100, loss : 0.50359, auc : 0.78453, accuracy : 0.75308
Epoch 40/100, valid auc : 0.76852, valid accuracy : 0.74135
Epoch 41/100, loss : 0.50274, auc : 0.78521, accuracy : 0.75358
Epoch 41/100, valid auc : 0.76952, valid accuracy : 0.74217
0.7690 to 0.7695
test_auc: 0.7670	test_accuracy: 0.7411	test_loss: 0.5282	
Epoch 42/100, loss : 0.50131, auc : 0.78650, accuracy : 0.75412
Epoch 42/100, valid auc : 0.76902, valid accuracy : 0.74264
Epoch 43/100, loss : 0.50106, auc : 0.78689, accuracy : 0.75481
Epoch 43/100, valid auc : 0.77039, valid accuracy : 0.74300
0.7695 to 0.7704
test_auc: 0.7682	test_accuracy: 0.7416	test_loss: 0.5272	
Epoch 44/100, loss : 0.49949, auc : 0.78873, accuracy : 0.75543
Epoch 44/100, valid auc : 0.77104, valid accuracy : 0.74289
0.7704 to 0.7710
test_auc: 0.7685	test_accuracy: 0.7419	test_loss: 0.5273	
Epoch 45/100, loss : 0.49889, auc : 0.78906, accuracy : 0.75625
Epoch 45/100, valid auc : 0.77010, valid accuracy : 0.74329
Epoch 46/100, loss : 0.49799, auc : 0.78979, accuracy : 0.75626
Epoch 46/100, valid auc : 0.77180, valid accuracy : 0.74353
0.7710 to 0.7718
test_auc: 0.7686	test_accuracy: 0.7425	test_loss: 0.5272	
Epoch 47/100, loss : 0.49722, auc : 0.79023, accuracy : 0.75639
Epoch 47/100, valid auc : 0.77047, valid accuracy : 0.74257
Epoch 48/100, loss : 0.49562, auc : 0.79168, accuracy : 0.75744
Epoch 48/100, valid auc : 0.77110, valid accuracy : 0.74302
Epoch 49/100, loss : 0.49527, auc : 0.79225, accuracy : 0.75807
Epoch 49/100, valid auc : 0.77161, valid accuracy : 0.74380
Epoch 50/100, loss : 0.49488, auc : 0.79279, accuracy : 0.75824
Epoch 50/100, valid auc : 0.77154, valid accuracy : 0.74304
Epoch 51/100, loss : 0.49434, auc : 0.79347, accuracy : 0.75926
Epoch 51/100, valid auc : 0.77256, valid accuracy : 0.74409
0.7718 to 0.7726
test_auc: 0.7693	test_accuracy: 0.7431	test_loss: 0.5273	
Epoch 52/100, loss : 0.49320, auc : 0.79419, accuracy : 0.75868
Epoch 52/100, valid auc : 0.77181, valid accuracy : 0.74320
Epoch 53/100, loss : 0.49175, auc : 0.79566, accuracy : 0.76021
Epoch 53/100, valid auc : 0.77041, valid accuracy : 0.74317
Epoch 54/100, loss : 0.49110, auc : 0.79614, accuracy : 0.76040
Epoch 54/100, valid auc : 0.77274, valid accuracy : 0.74440
0.7726 to 0.7727
test_auc: 0.7692	test_accuracy: 0.7432	test_loss: 0.5274	
Epoch 55/100, loss : 0.49094, auc : 0.79611, accuracy : 0.76073
Epoch 55/100, valid auc : 0.77348, valid accuracy : 0.74449
0.7727 to 0.7735
test_auc: 0.7699	test_accuracy: 0.7438	test_loss: 0.5276	
Epoch 56/100, loss : 0.48933, auc : 0.79713, accuracy : 0.76114
Epoch 56/100, valid auc : 0.77338, valid accuracy : 0.74475
Epoch 57/100, loss : 0.48905, auc : 0.79772, accuracy : 0.76185
Epoch 57/100, valid auc : 0.77185, valid accuracy : 0.74309
Epoch 58/100, loss : 0.48880, auc : 0.79778, accuracy : 0.76141
Epoch 58/100, valid auc : 0.77307, valid accuracy : 0.74382
Epoch 59/100, loss : 0.48756, auc : 0.79868, accuracy : 0.76178
Epoch 59/100, valid auc : 0.77367, valid accuracy : 0.74469
0.7735 to 0.7737
test_auc: 0.7700	test_accuracy: 0.7431	test_loss: 0.5274	
Epoch 60/100, loss : 0.48727, auc : 0.79922, accuracy : 0.76253
Epoch 60/100, valid auc : 0.77357, valid accuracy : 0.74420
Epoch 61/100, loss : 0.48590, auc : 0.80010, accuracy : 0.76210
Epoch 61/100, valid auc : 0.77231, valid accuracy : 0.74409
Epoch 62/100, loss : 0.48605, auc : 0.80050, accuracy : 0.76307
Epoch 62/100, valid auc : 0.77316, valid accuracy : 0.74384
Epoch 63/100, loss : 0.48514, auc : 0.80082, accuracy : 0.76344
Epoch 63/100, valid auc : 0.77355, valid accuracy : 0.74386
Epoch 64/100, loss : 0.48399, auc : 0.80203, accuracy : 0.76414
Epoch 64/100, valid auc : 0.77291, valid accuracy : 0.74406
Epoch 65/100, loss : 0.48412, auc : 0.80179, accuracy : 0.76406
Epoch 65/100, valid auc : 0.77288, valid accuracy : 0.74442
Epoch 66/100, loss : 0.48356, auc : 0.80275, accuracy : 0.76432
Epoch 66/100, valid auc : 0.77180, valid accuracy : 0.74393
Epoch 67/100, loss : 0.48249, auc : 0.80358, accuracy : 0.76418
Epoch 67/100, valid auc : 0.77286, valid accuracy : 0.74446
Epoch 68/100, loss : 0.48233, auc : 0.80382, accuracy : 0.76432
Epoch 68/100, valid auc : 0.77293, valid accuracy : 0.74464
Epoch 69/100, loss : 0.48208, auc : 0.80369, accuracy : 0.76417
Epoch 69/100, valid auc : 0.77248, valid accuracy : 0.74382
Epoch 70/100, loss : 0.48069, auc : 0.80485, accuracy : 0.76560
Epoch 70/100, valid auc : 0.77254, valid accuracy : 0.74386
Epoch 71/100, loss : 0.48033, auc : 0.80549, accuracy : 0.76564
Epoch 71/100, valid auc : 0.77278, valid accuracy : 0.74409
Epoch 72/100, loss : 0.47923, auc : 0.80628, accuracy : 0.76657
Epoch 72/100, valid auc : 0.77223, valid accuracy : 0.74404
Epoch 73/100, loss : 0.47938, auc : 0.80587, accuracy : 0.76603
Epoch 73/100, valid auc : 0.77250, valid accuracy : 0.74458
Epoch 74/100, loss : 0.47765, auc : 0.80772, accuracy : 0.76656
Epoch 74/100, valid auc : 0.77287, valid accuracy : 0.74426
Epoch 75/100, loss : 0.47754, auc : 0.80757, accuracy : 0.76667
Epoch 75/100, valid auc : 0.77256, valid accuracy : 0.74373
Epoch 76/100, loss : 0.47703, auc : 0.80821, accuracy : 0.76718
Epoch 76/100, valid auc : 0.77152, valid accuracy : 0.74251
Epoch 77/100, loss : 0.47674, auc : 0.80853, accuracy : 0.76696
Epoch 77/100, valid auc : 0.77235, valid accuracy : 0.74378
Epoch 78/100, loss : 0.47600, auc : 0.80883, accuracy : 0.76732
Epoch 78/100, valid auc : 0.76815, valid accuracy : 0.74148
Epoch 79/100, loss : 0.47508, auc : 0.80992, accuracy : 0.76758
Epoch 79/100, valid auc : 0.77245, valid accuracy : 0.74355
Epoch 80/100, loss : 0.47450, auc : 0.81037, accuracy : 0.76881
Epoch 80/100, valid auc : 0.77230, valid accuracy : 0.74297
Epoch 81/100, loss : 0.47403, auc : 0.81072, accuracy : 0.76843
Epoch 81/100, valid auc : 0.77034, valid accuracy : 0.74353
Epoch 82/100, loss : 0.47402, auc : 0.81085, accuracy : 0.76864
Epoch 82/100, valid auc : 0.77181, valid accuracy : 0.74353
Epoch 83/100, loss : 0.47331, auc : 0.81141, accuracy : 0.76904
Epoch 83/100, valid auc : 0.77042, valid accuracy : 0.74360
Epoch 84/100, loss : 0.47232, auc : 0.81185, accuracy : 0.76888
Epoch 84/100, valid auc : 0.77130, valid accuracy : 0.74304
Epoch 85/100, loss : 0.47266, auc : 0.81178, accuracy : 0.76959
Epoch 85/100, valid auc : 0.77150, valid accuracy : 0.74342
Epoch 86/100, loss : 0.47105, auc : 0.81339, accuracy : 0.76978
Epoch 86/100, valid auc : 0.77085, valid accuracy : 0.74355
Epoch 87/100, loss : 0.47057, auc : 0.81367, accuracy : 0.76983
Epoch 87/100, valid auc : 0.77097, valid accuracy : 0.74275
Epoch 88/100, loss : 0.47035, auc : 0.81392, accuracy : 0.77033
Epoch 88/100, valid auc : 0.76916, valid accuracy : 0.74228
Epoch 89/100, loss : 0.46922, auc : 0.81484, accuracy : 0.77068
Epoch 89/100, valid auc : 0.77161, valid accuracy : 0.74357
Epoch 90/100, loss : 0.46946, auc : 0.81484, accuracy : 0.77049
Epoch 90/100, valid auc : 0.76864, valid accuracy : 0.74146
Epoch 91/100, loss : 0.46962, auc : 0.81455, accuracy : 0.77050
Epoch 91/100, valid auc : 0.77009, valid accuracy : 0.74248
Epoch 92/100, loss : 0.46839, auc : 0.81549, accuracy : 0.77188
Epoch 92/100, valid auc : 0.77070, valid accuracy : 0.74226
Epoch 93/100, loss : 0.46754, auc : 0.81617, accuracy : 0.77189
Epoch 93/100, valid auc : 0.76968, valid accuracy : 0.74264
Epoch 94/100, loss : 0.46705, auc : 0.81658, accuracy : 0.77167
Epoch 94/100, valid auc : 0.76962, valid accuracy : 0.74248
Epoch 95/100, loss : 0.46563, auc : 0.81750, accuracy : 0.77185
Epoch 95/100, valid auc : 0.76985, valid accuracy : 0.74251
Epoch 96/100, loss : 0.46604, auc : 0.81759, accuracy : 0.77229
Epoch 96/100, valid auc : 0.76900, valid accuracy : 0.74208
Epoch 97/100, loss : 0.46531, auc : 0.81784, accuracy : 0.77264
Epoch 97/100, valid auc : 0.76946, valid accuracy : 0.74177
Epoch 98/100, loss : 0.46421, auc : 0.81862, accuracy : 0.77329
Epoch 98/100, valid auc : 0.76980, valid accuracy : 0.74217
Epoch 99/100, loss : 0.46469, auc : 0.81814, accuracy : 0.77284
Epoch 99/100, valid auc : 0.76891, valid accuracy : 0.74095
Epoch 100/100, loss : 0.46341, auc : 0.81933, accuracy : 0.77387
Epoch 100/100, valid auc : 0.76752, valid accuracy : 0.74122
best outcome: best epoch: 59.0000
valid_auc: 0.7737	valid_accuracy: 0.7447	valid_loss: 0.5227	
test_auc: 0.7700	test_accuracy: 0.7431	test_loss: 0.5274	
